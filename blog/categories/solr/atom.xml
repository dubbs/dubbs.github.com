<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Solr | Kevin Warrington]]></title>
  <link href="http://dubbs.github.io/blog/categories/solr/atom.xml" rel="self"/>
  <link href="http://dubbs.github.io/"/>
  <updated>2015-07-03T11:52:01-06:00</updated>
  <id>http://dubbs.github.io/</id>
  <author>
    <name><![CDATA[Kevin Warrington]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Installing Solr 4 on CentOS 6]]></title>
    <link href="http://dubbs.github.io/blog/2015/06/29/installing-solr-on-centos-6/"/>
    <updated>2015-06-29T11:40:14-06:00</updated>
    <id>http://dubbs.github.io/blog/2015/06/29/installing-solr-on-centos-6</id>
    <content type="html"><![CDATA[<h2>Verify CentOS Version</h2>

<pre><code class="bash">cat /etc/centos-release
</code></pre>

<h2>Install Tomcat</h2>

<pre><code class="bash"># install java-1.7.0-openjdk
sudo yum -y install java-1.7.0-openjdk
# install tomcat6
sudo yum -y install tomcat6 tomcat6-webapps tomcat6-admin-webapps
# change port
sudo sed -i s/8080/8983/g /etc/tomcat6/server.xml
# install Simple Logging Facade for Java
wget -qO- http://www.slf4j.org/dist/slf4j-1.7.12.tar.gz | tar xvz
sudo cp -a slf4j-1.7.12/slf4j-*.jar /usr/share/tomcat6/lib
# remove android files that mess up startup
sudo rm -rf /usr/share/tomcat6/lib/slf4j-android*
# install Apache Commons Logging
wget -qO- http://apache.mirror.rafal.ca//commons/logging/binaries/commons-logging-1.2-bin.tar.gz | tar xvz
sudo cp -a commons-logging-1.2/commons-logging-1.2*.jar /usr/share/tomcat6/lib
</code></pre>

<p>To use the manager webapp you need to create a user with the role &ldquo;manager&rdquo;.  Add a user to <code>&lt;tomcat-users&gt;</code> in <code>/etc/tomcat6/tomcat-users.xml</code></p>

<pre><code class="xml">&lt;role rolename="manager" /&gt;
&lt;role rolename="admin" /&gt;
&lt;user username="admin" password="password" roles="manager,admin" /&gt;
</code></pre>

<p>Start tomcat</p>

<pre><code class="bash">sudo service tomcat6 start
</code></pre>

<p>Open the <a href="http://admin:password@localhost:8983/manager/html">Tomcat Web Application Manager</a></p>

<h2>Install Solr</h2>

<pre><code class="bash">wget http://archive.apache.org/dist/lucene/solr/4.6.1/solr-4.6.1.tgz
tar xvf solr-4.6.1.tgz
# install solr app
sudo cp -a solr-4.6.1/dist/solr-4.6.1.war /var/lib/tomcat6/webapps/solr.war
# copy default example config to home, where data will live
sudo cp -a solr-4.6.1/example/solr /home/
# set appropriate permissions
sudo chown -R tomcat:tomcat /home/solr /var/lib/tomcat6/webapps/solr
# update solr home directory in WEB-INF
#    &lt;env-entry&gt;
#       &lt;env-entry-name&gt;solr/home&lt;/env-entry-name&gt;
#       &lt;env-entry-value&gt;/home/solr&lt;/env-entry-value&gt;
#       &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;
#    &lt;/env-entry&gt;
sudo vim /var/lib/tomcat6/webapps/solr/WEB-INF/web.xml
# restart so tomcat creates directory
sudo service tomcat6 restart
</code></pre>

<h2>Create a new core</h2>

<pre><code class="bash">cd /home/solr
sudo cp -a collection1 document_library
# update core name
echo 'name=document_library' | sudo tee document_library/core.properties
# clean data directory
sudo rm -rf document_library/data
sudo mkdir document_library/data
sudo chown -R tomcat:tomcat document_library
</code></pre>

<h2>Add drupal solr configuration to new core</h2>

<pre><code class="bash">sudo cp /vagrant/htdocs/sites/all/modules/apachesolr/solr-conf/solr-4.x/* /home/solr/document_library/conf/
sudo chown -R tomcat:tomcat document_library
sudo service tomcat6 restart
</code></pre>
]]></content>
  </entry>
  
</feed>
